const PARAMS={AMOUNT:50,MAX_AMOUNT:2e3,SCALE_BASE:.3,SPEED_BASE:1,ROTATIONSPEED_BASE:.03,RADIUS:100,STRENGTH:3},ISMOBILE=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);class AppRain extends PIXI.Application{constructor(t){super(t)}loadTextures(){return new Promise((t,e)=>{this.textures?t():assetsToTextures(assets).then(e=>{this.textures=e,t()})})}startRainingEffect(){this.loadTextures().then(this.createAssets.bind(this))}init(){this.mouse=vec2.fromValues(-1e3,-1e3),window.addEventListener("touchstart",this.onTouchStart.bind(this),!1),window.addEventListener("touchmove",this.onTouchMove.bind(this),!1),window.addEventListener("touchend",this.onTouchEnd.bind(this),!1),ISMOBILE||(window.addEventListener("mousemove",this.onMouseMove.bind(this),!1),window.addEventListener("mousedown",this.onMouseDown.bind(this),!1),window.addEventListener("mouseup",this.onMouseUp.bind(this),!1));let t=document.createElement("div");return t.id="canvas",document.body.appendChild(t),t.appendChild(this.view),t.classList.add("rain"),this.resizeTo=t,this.time=0,this.ticker.add(t=>{if(this.time+=1,!ISMOBILE&&this.mouseDown&&1===Math.round(this.time%6)){let t=this.textures[Math.floor(Math.random()*this.textures.length)],e=vec2.create();vec2.add(e,this.mouseDown,vec2.fromValues(100*Math.random()*(Math.random()>.5?1:-1),100*Math.random()*(Math.random()>.5?1:-1))),this.assets.push(new Asset(t,e)),this.assets.length>PARAMS.MAX_AMOUNT&&this.assets.shift().remove()}this.assets&&this.assets.forEach(t=>{t.update()})}),this}createAssets(){this.assets=[];for(let t=0;t<PARAMS.AMOUNT;t++){let t=this.textures[Math.floor(Math.random()*this.textures.length)];this.assets.push(new Asset(t))}}onMouseMove(t){this.mouse=vec2.fromValues(t.clientX,t.clientY),this.mouseDown&&(this.mouseDown=this.mouse)}onMouseDown(t){this.mouseDown=vec2.fromValues(t.clientX,t.clientY)}onMouseUp(t){this.mouseDown=null}onTouchStart(t){}onTouchMove(t){this.mouse=vec2.fromValues(t.touches[0].clientX,t.touches[0].clientY),this.mouseDown&&(this.mouseDown=this.mouse)}onTouchEnd(t){this.mouse=vec2.fromValues(-1e3,-1e3),this.mouseDown=null}}class Asset{constructor(t,e=null){this.position=e,this.texture=t,this.init()}init(){this.sprite=new PIXI.Sprite(this.texture),this.scale=PARAMS.SCALE_BASE+Math.random()/10,this.size=vec2.fromValues(this.texture.baseTexture.width*this.scale,this.texture.baseTexture.height*this.scale),this.position=this.position||vec2.fromValues(appRain.screen.width*Math.random(),-(appRain.screen.height+10*this.size[1])*Math.random()-this.size[1]/2),this.speed=vec2.fromValues(0,PARAMS.SPEED_BASE+Math.random()/2),this.rotation=360*Math.random(),this.rotationSpeed=PARAMS.ROTATIONSPEED_BASE+Math.random()/100,this.sprite.anchor.x=.5,this.sprite.anchor.y=.5,appRain.stage.addChild(this.sprite)}update(){if(vec2.add(this.position,this.position,this.speed),vec2.distance(this.position,appRain.mouse)<PARAMS.RADIUS){let t=vec2.create();vec2.subtract(t,this.position,appRain.mouse),vec2.normalize(t,t),vec2.multiply(t,t,vec2.fromValues(PARAMS.STRENGTH,PARAMS.STRENGTH)),vec2.add(this.position,this.position,t),this.rotation+=this.rotationSpeed}this.position[1]-this.size[1]>appRain.screen.height&&(this.position=vec2.fromValues(appRain.screen.width*Math.random(),-(appRain.screen.height+10*this.size[1])*Math.random()-this.size[1]/2)),this.sprite.x=this.position[0],this.sprite.y=this.position[1],this.sprite.scale.x=this.scale,this.sprite.scale.y=this.scale,this.sprite.rotation=this.rotation}remove(){appRain.stage.removeChild(this.sprite)}}const assets=["https://rocheclement.fr/public/images/kolour/1.svg","https://rocheclement.fr/public/images/kolour/2.svg","https://rocheclement.fr/public/images/kolour/3.svg","https://rocheclement.fr/public/images/kolour/4.svg","https://rocheclement.fr/public/images/kolour/5.svg","https://rocheclement.fr/public/images/kolour/6.svg","https://rocheclement.fr/public/images/kolour/7.svg","https://rocheclement.fr/public/images/kolour/8.svg","https://rocheclement.fr/public/images/kolour/9.svg","https://rocheclement.fr/public/images/kolour/10.svg"];function assetsToTextures(t){const e=new PIXI.Loader,s=[];return t.forEach((t,s)=>{e.add(s.toString(),t)}),e.load((t,e)=>{}),new Promise((t,i)=>{e.onComplete.add((e,i)=>{Object.keys(i).forEach(e=>{let o=i[e];s.push(o.texture),t(s)})})})}let appRain=new AppRain({width:window.innerWidth,height:window.innerHeight,transparent:!0,resolution:window.devicePixelRatio||1,resizeTo:window,forceFXAA:!0,powerPreference:"high-performance"});appRain.init().startRainingEffect();
